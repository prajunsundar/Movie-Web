{% extends 'admin base.html' %}

{% block content %}

<section class="" style="background-color: #eee;">
  <div class="container">
    <div class="row d-flex justify-content-center align-items-center">
      <div class="col-lg-12 col-xl-11">
        <div class="card my-card" style="border-radius: 25px;">
          <div class="card-body p-md-5">
            <div class="row justify-content-center">
              <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">

                <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4">Add New Show</p>

                <form method="post" class="mx-1 mx-md-4 " enctype="multipart/form-data">

                  {% csrf_token %}
                    <div class="row">
                        <div class="col-6" style="margin-right:10px;padding:5px;">
                            <div class="column">
                                <label>Movie</label>
                                <select name="movie" id="movie-select" required>
                                    <option value="">Choose one</option>
                                    {% for m in movies %}
                                    <option value="{{ m.id }}" data-language="{{ m.language }}">{{ m.title }}</option>
                                    {% endfor %}
                                </select>
                                <label>Theater</label>
                                <select name="screen" id="screen-select">
                                    <option value="">Choose one</option>
                                    {% for s in screens %}
                                    <option value="{{ s.id }}">{{ s.theater.name }} - {{ s.screen }}</option>
                                    {% endfor %}
                                </select>

                                <label>Language</label>
                                <select name="language" id="language-select" readonly>
                                    <option value="">Choose one</option>
                                </select>
                            </div>

                        </div>


                        <div class="col-6" style="margin-left:10px;padding:5px;">
                            <div class="column">
                                <label for="the-name">Poster</label>
                                <input type="file" name="poster" id="the-name" required>

                                <label for="the-email">Date</label>
                                <input type="date" name="date" id="the-email" required>

                                <label for="the-email">Start Time</label>
                                <input type="time" name="start_time" id="the-email" required>

                                <label for="the-email">End Time</label>
                                <input type="time" name="end_time" id="the-email" required>

                                <label for="the-email">Ticket Price</label>
                                <input type="number" name="ticket" id="the-email" min="0" required>

                            </div>
                        </div>


                  <div class="d-flex justify-content-center mx-4 mb-3 mb-lg-4">
                    <button  type="submit" data-mdb-button-init data-mdb-ripple-init class="btn btn-primary btn-lg">Add</button>
                  </div>

                </form>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<script>
{% if messages %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        {% for message in messages %}
            Swal.fire({
                icon: "{% if message.tags %}{{ message.tags }}{% else %}info{% endif %}",
                title: "{{ message|escapejs }}",
                showConfirmButton: false,
                timer: 3000
            });
        {% endfor %}
    });
</script>
{% endif %}

document.getElementById('movie-select').addEventListener('change', function() {
    let selectedOption = this.options[this.selectedIndex];
    let language = selectedOption.getAttribute('data-language');

    let languageSelect = document.getElementById('language-select');
    languageSelect.innerHTML = ""; // Clear old options

    if (language) {
        let opt = document.createElement("option");
        opt.value = language;
        opt.textContent = language;
        opt.selected = true;
        languageSelect.appendChild(opt);
    }
});
</script>







{% endblock %}